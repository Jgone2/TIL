# 프로세스 관리

- 각 프로세스 자원을 다른 프로세스로부터 보호
- 프로세스마다 작업 시간을 할당
- 작업에 우선순위를 매김

→ 여러 작업이 동시에 이뤄질 때 효율적으로 작업을 처리하기 위해 프로세스를 관리하는 행위

# 1. 프로세스

- 커널에 등록되고 커널의 관리하에 있는 작업
- 프로세스 제어 블록(PCB)을 할당받는 개체
- 각종 자원들을 요청하고 할당받을 수 있는 개체
- 프로세서(처리기, CPU)에 의해 처리되는 프로그램

→ 실행중인 프로그램

# 2. PCB(Process Control Block, 프로세스 제어 블록)

- 운영체제가 프로세스에 대한 각종 정보들을 저장하여 프로세스를 관리할 때 사용
- PCB에 저장되어 있는 정보
  - 프로세스 고유 식별자(Process Identification Number, PIN)
  - 프로세스 우선순위(Priority)
  - 프로세스의 현재 상태
  - 할당받은 자원들의 리스트 or 자원들에 대한 포인터
  - CPU 레지스터 정보(누산기(AC), 프로그램 카운터(PC) 등이 속함)
  - 주기억장치 관리정보(페이지 테이블 등)
  - 입/출력 상태 정보
  - 계정 정보

# 3. 프로세스 상태

- 생성(New): 작업이 메모리에 할당되어 프로세스가 처음 생성되는 상태  
  → 제출(Submit)과 접수(Hold)의 작업 수행
- 준비(Ready): 프로세스가 프로세서를 할당받기 위해 기다리고 있는 상태  
  → 생성에서 준비 상태로의 전이는 Job 스케줄러에 의해 수행
- 실행(Run): 준비상태 큐에 있는 프로세스가 프로세서를 할당받아 실행되는 상태
  - 수행이 완료되기 전에 프로세스에게 주어진 프로세서 할당 시간이 종료되면 프로세스는 준비상태로 전이  
    → 해당 작업이 끝나면 다시 CPU 스케줄러에 의해 실행되기 위해 Ready 상태로 돌아가야 한다.
- 대기(Wait): 프로세스에 I/O 처리가 필요하면 현재 실행중인 프로세스(또는 CPU)가 중단되고 I/O 처리가 완료될 때까지 대기하고 있는 상태
- 종료(Exit): 프로세스의 실행이 끝나고 프로세스 할당이 해제된 상태

## 1. 프로세스 상태 전이

- 프로세스가 시스템 내에 존재하는 동안 프로세스의 상태가 변하는 것

![프로세스 상태 전이](https://media.vlpt.us/images/mainxcharacter/post/0051a678-9750-4be8-9cd7-5effde749e44/image.png)

- Dispatch: 프로세스 스케줄러에 의해 결정된 우선순위에 따라 프로세스가 CPU를 점유하게 되는 상태
- Time out(선점, 시간초과): 프로세스가 실행중이다가 제한된 시간을 다 소비하여 CPU 점유를 빼앗기는 상태
- Block: 실행중이던 프로세스가 외부 요인에 의해서 자원을 빼앗기는 상태
- Wake up: 프로세스가 자원을 할당받는 상태

### 1. 지연 상태

- 지연 상태: 프로세스가 처음 생성되었을 당시에 프로세스를 위한 기억장치의 용량이 충분하지 않은 경우 발생
- 지연 상태에서 발생할 수 있는 프로세스 전이

  - Swap in(resume): 프로세스가 주기억장치에 적재되는 상태
  - Swap out(suspend): 프로세스가 주기억장치에서 해제되는 상태

- 지연 준비 상태(Suspended Ready)
  - 프로 세스가 생성된 후 기억장치의 용량이 부족할 경우
  - 이미 기억장치를 할당받았으나 기억장치를 빼앗긴 경우
- 지연 대기 상태(Suspended Blocked)
  - 대기 상태에 있던 프로세스가 기억장치를 빼앗긴 경우
  - 프로세스에게 다시 할당될 경우 원래의 대기 상태로 전이
  - 지연 대기 상태의 프로세스가 요청하고 기다리던 자원이 할당될 경우 지연 준비 상태로 전이

### 2. 지연상태 발생원인

- 시스템 용량 확보
- 시스템 성능 확보
- 시스템 안정성 측면
- 프로세스가 종료된 후 메모리 공간에 PCB 등의 정보가 남아 있는 상태

# 4. 스케줄링(Scheduling)

- 프로세스가 생성되어 실행될 때 필요한 시스템의 여러 자원을 해당 프로세스에게 할당하는 작업

## 1. 스케줄링 종류

- `장기 스케줄링`
  - 어떤 프로세스가 시스템의 자원을 차지할 수 있도록 할 것인가를 결정
  - 결정된 프로세스를 준비상태 큐로 전이
  - 작업 스케줄링(Job Scheduling)이라고도 하며, Job 스케줄러에 수행
- `중기 스케줄링`
  - 어떤 프로세스들이 CPU를 할당받을 것인지 결정
  - 할당받으려는 프로세스가 많을경우 일시 보류와 활성화를 사용해서 프로세서 부하 조절
- `단기 스케줄링`
  - 프로세스가 실행되기 위해 CPU를 할당받는 시기와 특정 프로세스를 지정하는 작업
  - 프로세서 스케줄링(Processor Scheduling)이라고도 불림
  - 프로세서 스케줄링 및 문맥 교환은 Processor 스케줄러에 의해 수행

> 💡 **문맥 교환(Context Switching)**  
> 한 프로세스에서 다른 프로세스로 CPU 할당을 옮기는 것.  
> 즉, 실행중인 프로세스가 멈추고 다른 프로세스가 실행되는 것

## 2. 스케줄링 목적

- CPU나 자원을 효율적으로 사용하기 위한 정책
- 목적의 종류
  - `공정성`: 모든 프로세스에 공정하게 할당
  - `처리율(량) 증가`: 단위 시간당 처리 비율 증가
  - `CPU 이용률 증가`: CPU 낭비 시간 ↓, 프로세스 실행에 사용되는 시간 ↑
  - `우선순위 제도`: 우선순위가 높은 프로세스 먼저 실행
  - `오버헤드 최소화`: 오버헤드 최소화
  - `응답 시간(Response Time, 반응 시간)최소화`: 작업 지시부터 반응하기 시작하는 시간 최소화
  - `반환 시간 최소화`: 프로세스 제출 시간부터 실행 완료까지의 시간 최소화
  - `대기 시간 최소화`: 프로세스가 준비상태 큐에서 대기하는 시간 최소화
  - `균형 있는 자원의 사용:` 메모리, I/O 장치 등을 균형있게 사용
  - `무한 연기 회피`: 자원 사용을 위해 무한정 연기되는 상태 회피

> 💡 **오버헤드**
> 어떤 처리를 하기 위해 들어가는 간접적인 처리 시간, 메모리 등으로  
> 정보 전송의 신뢰성 확보 및 시스템의 안정적 운용 등을 위하여 실제 운반되는 정보에 추가되는  
> 성격의 운용 및 유지보수를 위한 신호를 말한다.

## 3. 프로세스 스케줄링 기법

- 스케줄링의 적용 시점에 따라 비선점형과 선점형으로 구분

### 1. 비선점(Non-Preemptive) 스케줄링

- 이미 할당된 CPU를 다른 프로세스가 강제로 빼앗을 수 없음
- 프로세스가 CPU를 한번 할당받으면 작업이 완료될 때까지 CPU를 사용

#### 장점

- 모든 프로세스를 공정하게 처리
- 응답 시간 예측 용이
- 일괄 처리 방식에 적합

#### 단점

- 무한 연기 가능성
- CPU 사용 시간이 긴 프로세스 존재 시, 처리율 떨어짐
- 중요한 작업이 중요하지 않은 작업을 기다리는 경우 발생

#### 종류

- FCFS(First Come First Service, 선입 선출) = FIFO(First In First Out): 준비상태 큐에 도착한 `순서대로` CPU 할당
- SJF(Shortest Job First, 단기 작업 우선): 준비상태 큐에 대기 중인 프로세스 들 중에서 `실행 시간이 가장 짧은 프로세스` 먼저 CPU 할당
- 우선순위: `높은 우선순위`를 가진 프로세스 먼저 CPU 할당
- HRN(Hightest Response-ratio Next): `우선순위 계산 공식`을 이용하여 실행 시간이 짧은 프로세스나 대기 시간이 긴 프로세스에게 `우선순위 부여` 후 CPU 할당(우선순위의 내림차순으로 CPU 할당)
- 기한부: 프로세스에게 `일정한 시간` CPU 할당시간 부여, timeout시 제거되거나 처음부터 다시 시작

> 💡 **우선순위 계산 공식**
> result = (대기 시간+서비스 시간)/서비스 시간

### 2. 선점(Preemptive) 스케줄링

- CPU를 할당 받아 실행중일 때 우선순위가 높은 다른 프로세스가 CPU를 강제로 빼앗아 점유 가능

#### 장점

- 우선순위가 높은 프로세스 신속 처리 가능
- 빠른 응답시간을 요구하는 프로그램에 사용가능(대화식 시분할 시스템)
- CPU 독점 방지 가능(인터럽트용 타이머 클록 → CPU 사용 시간 배당)

#### 단점

- 많은 오버헤드 초래

#### 종류

- RR(Round Robin): `시분할 시스템`에서 사용, FIFO방식을 기본으로 하나 `timeout시 다음 프로세스`에게 CPU 할당
- SRT(Shortest Remaining Time): SJF방식의 선점형
- 선점 우선순위
- 다단계 큐: 프로세스 우선순위에 따라 시스템 프로세스, 대화형 프로세스, 일괄처리 프로세스 등으로 나누어 `준비상태 큐의 우선순위`순으로 실행

![](https://mblogthumb-phinf.pstatic.net/20120626_114/rlaauddlf200_1340636474963qe7SM_PNG/2.png?type=w2)

- 다단계 피드백 큐: 다단계 큐 방식을 기본방식으로 timeout시 우선순위가 낮은 다음단계 큐로 이동

# 📚 Reference

- [Process management](https://github.com/jx-dohwan/CS/blob/main/Process%20management.md)
- [5.프로세스 관리](https://velog.io/@codemcd/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9COS-5.-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EA%B4%80%EB%A6%AC)
- [프로세스의 개요](https://velog.io/@mainxcharacter/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%9D%98-%EA%B0%9C%EC%9A%94)
- [프로세스 스케줄링이란?](https://junsday.tistory.com/28?category=897242)
- [비선점 or 선점형 스케줄링](https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=rlaauddlf200&logNo=30141162460)
